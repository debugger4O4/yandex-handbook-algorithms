## Подсчет транспозиций (усложненная).

```
Ограничение времени 1 с
Ограничение памяти 256.0 Мб
Ввод стандартный ввод или input.txt
Вывод стандартный вывод или output.txt
```

Дана перестановка `p` из `n` целых чисел. Необходимо вычислить, какое минимальное количество транспозиций требуется совершить,
чтобы упорядочить элементы перестановки хорошо.

Будем говорить, что элементы перестановки упорядочены хорошо, если найдется такое число `x` от 1 до `n`, что перестановка
имеет вид `x, x + 1, …, n, 1, 2, …, x − 1`.

Транспозиция -- это обмен соседних элементов перестановки `p` местами.

### Формат ввода.
Первая строка содержит целое число `n`, следующая — последовательность целых чисел `p0, ..., pn-1 `.

Ограничения: `1 ≤ n ≤ 30000, 1 ≤ pi ≤ n` для всех `0 ≤ i ≤ n - 1`. Все `pi` различны.

### Формат вывода.
Минимальное количество транспозиций.
